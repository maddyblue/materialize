# Copyright Materialize, Inc. and contributors. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License in the LICENSE file at the
# root of this repository, or online at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

parse-statement
COPY t(a, b) FROM STDIN
----
COPY t(a, b) FROM STDIN
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [Ident("a"), Ident("b")] }, direction: From, target: Stdin, options: [] })

parse-statement
COPY t FROM STDIN
----
COPY t FROM STDIN
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [] }, direction: From, target: Stdin, options: [] })

parse-statement
COPY (select 1) TO STDOUT
----
COPY (SELECT 1) TO STDOUT
=>
Copy(CopyStatement { relation: Select(SelectStatement { query: Query { ctes: Simple([]), body: Select(Select { distinct: None, projection: [Expr { expr: Value(Number("1")), alias: None }], from: [], selection: None, group_by: [], having: None, options: [] }), order_by: [], limit: None, offset: None }, as_of: None }), direction: To, target: Stdout, options: [] })

parse-statement
COPY t(a, b) TO STDOUT
----
COPY t(a, b) TO STDOUT
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [Ident("a"), Ident("b")] }, direction: To, target: Stdout, options: [] })

parse-statement
COPY t TO STDOUT WITH (FORMAT TEXT)
----
COPY t TO STDOUT WITH (FORMAT = text)
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [] }, direction: To, target: Stdout, options: [CopyOption { name: Format, value: Some(Ident(Ident("text"))) }] })

parse-statement
COPY t FROM STDIN WITH (FORMAT CSV, DELIMITER '|')
----
COPY t FROM STDIN WITH (FORMAT = csv, DELIMITER = '|')
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [] }, direction: From, target: Stdin, options: [CopyOption { name: Format, value: Some(Ident(Ident("csv"))) }, CopyOption { name: Delimiter, value: Some(Value(String("|"))) }] })

parse-statement
COPY t TO STDOUT (format = text)
----
COPY t TO STDOUT WITH (FORMAT = text)
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("t")])), columns: [] }, direction: To, target: Stdout, options: [CopyOption { name: Format, value: Some(Ident(Ident("text"))) }] })

parse-statement
COPY t TO STDOUT ()
----
error: Expected one of FORMAT or DELIMITER or NULL or ESCAPE or QUOTE or HEADER or CSV or CREDENTIALS or REGION or GZIP or IGNOREHEADER or TIMEFORMAT or DATEFORMAT or TRUNCATECOLUMNS or ACCEPTINVCHARS or ENCRYPTED or MANIFEST, found right parenthesis
COPY t TO STDOUT ()
                  ^

parse-statement
COPY t TO STDIN
----
error: Expected STDOUT, found STDIN
COPY t TO STDIN
          ^

parse-statement
COPY (select 1) FROM STDIN
----
error: queries not allowed in COPY FROM
COPY (select 1) FROM STDIN
                ^

# WITH must be followed by open paren.
parse-statement
COPY t TO STDOUT WITH
----
error: Expected left parenthesis, found EOF
COPY t TO STDOUT WITH
                     ^

parse-statement
COPY "google_sheets"."sheet" ("_row", "a", "b", "_fivetran_synced")
FROM 's3://datawriterprd-us-east-1/89dbb4d9-bc11-417d-ac19-e18044e51e75/upload.manifest'
CREDENTIALS 'aws_access_key_id=ASIA4ESR5FO4SE5RUUXW;aws_secret_access_key=9FnLJQdZL4iaJZEubCL3wlWTAoBNeMVm2UNfgkOC;token=IQoJb3JpZ2luX2VjEJf//////////wEaCXVzLWVhc3QtMSJGMEQCIDa1r+0mo9PWr6DoGpknFZpxO/SGbU/NWYUoS6Co8IWwAiBjIQo1/4hnmGZDD/VeFP7JEEw0wAc56RNdQFVIM4m+6yqgBAiv//////////8BEAAaDDgzNDQ2OTE3ODI5NyIM5SnwMe7q4RPetSlaKvQDegM48jz4iCqwVdprUWvORZNU0MS9ZHlBzVD+oR6Ue78Va2NgOAwLpg8DllEMMw5bCjpYBPIaF8+fHL+CUcvNcobLGAUPdOwNv2ZiZmJhR9Ty/N5gcYQ5lfzFXdzHTTs1fqLq3UUiTC/W4YU+yDQTniBtCN0Tc8XnG9PKUcqdUWSAhF2sob2O+yr8RHyC4fG50KjP7GcQka9rR+fW5t44PU2j7Dv4dgOioscDrTN6Uwh3KDMPsCiVQj+YvBYIoGGMpeRvfqKzDKNkAd5I4ukIKku8BCrtCHF8DUKwWIHiKJjWfKUvVKq0kxsSB6y4a9jdQoZMe1i/JUUWE1EQE3HzPirE8OpUmyO2wtRpKrRQv1nr055zaIUmABVOr95sbM4tOCvzb/uqREHAjR/TXjUqrNQQC4jlAkBETU/r//HABZ2aVaKdMFPHpXByxJsokehXEFuJqFwpkk5V4NPmD0dEjKBfEZRRFz7vvxMjd0At2Wc68OASIXs8vgOHyDlBv0St6Ps7N2wWdzsKB8WOJZoTK2ZKfjXv6xgTGxqVUuUFpc2/yIzwz/qsYFNqCtJWrYMPIOuv6aHK9uyrSRWNaWVIw2IeGNhEnta0h2uo8M2oPb5L6ymPSavykHDKk/U93fOgG/H1T84nMeKW+RzYo8JDG4ZNcIMwpNH1ogY6ngEH/Ec+sHs4zG+nReaRn8PFGF/TaeB9ixCkFinWfmBVRM8Hlq6+ZgE3nvvjJNRlJj39h7N9OZLINjPPUNCF5GLa0kDA9Rloh3p8R9Zn7y2gh5UC2rRW3uea7FTzDRisbJbFjEaGYqOqJ0x/4D9vRZ+7lJnnkNPPB0FMUjMew6XvWRxH4tlZZmwMkiGavea3o9TGAlh/LKHhzHKfjC/B7A==;master_symmetric_key=/bnBIznZImOA+cpQSl9UeKIkOeBCNfh6mTuyXC6Sq7E='
REGION 'us-east-1'
CSV GZIP IGNOREHEADER 1
NULL 'null-vba3aoqjpgeovgjvmzn5cklcstanclr'
TIMEFORMAT 'auto'
DATEFORMAT 'auto'
TRUNCATECOLUMNS ACCEPTINVCHARS ENCRYPTED MANIFEST
;
----
COPY google_sheets.sheet(_row, a, b, _fivetran_synced) FROM 's3://datawriterprd-us-east-1/89dbb4d9-bc11-417d-ac19-e18044e51e75/upload.manifest' WITH (CREDENTIALS = 'aws_access_key_id=ASIA4ESR5FO4SE5RUUXW;aws_secret_access_key=9FnLJQdZL4iaJZEubCL3wlWTAoBNeMVm2UNfgkOC;token=IQoJb3JpZ2luX2VjEJf//////////wEaCXVzLWVhc3QtMSJGMEQCIDa1r+0mo9PWr6DoGpknFZpxO/SGbU/NWYUoS6Co8IWwAiBjIQo1/4hnmGZDD/VeFP7JEEw0wAc56RNdQFVIM4m+6yqgBAiv//////////8BEAAaDDgzNDQ2OTE3ODI5NyIM5SnwMe7q4RPetSlaKvQDegM48jz4iCqwVdprUWvORZNU0MS9ZHlBzVD+oR6Ue78Va2NgOAwLpg8DllEMMw5bCjpYBPIaF8+fHL+CUcvNcobLGAUPdOwNv2ZiZmJhR9Ty/N5gcYQ5lfzFXdzHTTs1fqLq3UUiTC/W4YU+yDQTniBtCN0Tc8XnG9PKUcqdUWSAhF2sob2O+yr8RHyC4fG50KjP7GcQka9rR+fW5t44PU2j7Dv4dgOioscDrTN6Uwh3KDMPsCiVQj+YvBYIoGGMpeRvfqKzDKNkAd5I4ukIKku8BCrtCHF8DUKwWIHiKJjWfKUvVKq0kxsSB6y4a9jdQoZMe1i/JUUWE1EQE3HzPirE8OpUmyO2wtRpKrRQv1nr055zaIUmABVOr95sbM4tOCvzb/uqREHAjR/TXjUqrNQQC4jlAkBETU/r//HABZ2aVaKdMFPHpXByxJsokehXEFuJqFwpkk5V4NPmD0dEjKBfEZRRFz7vvxMjd0At2Wc68OASIXs8vgOHyDlBv0St6Ps7N2wWdzsKB8WOJZoTK2ZKfjXv6xgTGxqVUuUFpc2/yIzwz/qsYFNqCtJWrYMPIOuv6aHK9uyrSRWNaWVIw2IeGNhEnta0h2uo8M2oPb5L6ymPSavykHDKk/U93fOgG/H1T84nMeKW+RzYo8JDG4ZNcIMwpNH1ogY6ngEH/Ec+sHs4zG+nReaRn8PFGF/TaeB9ixCkFinWfmBVRM8Hlq6+ZgE3nvvjJNRlJj39h7N9OZLINjPPUNCF5GLa0kDA9Rloh3p8R9Zn7y2gh5UC2rRW3uea7FTzDRisbJbFjEaGYqOqJ0x/4D9vRZ+7lJnnkNPPB0FMUjMew6XvWRxH4tlZZmwMkiGavea3o9TGAlh/LKHhzHKfjC/B7A==;master_symmetric_key=/bnBIznZImOA+cpQSl9UeKIkOeBCNfh6mTuyXC6Sq7E=', REGION = 'us-east-1', CSV = true, GZIP = true, IGNOREHEADER = 1, NULL = 'null-vba3aoqjpgeovgjvmzn5cklcstanclr', TIMEFORMAT = 'auto', DATEFORMAT = 'auto', TRUNCATECOLUMNS = true, ACCEPTINVCHARS  = true, ENCRYPTED = true, MANIFEST = true)
=>
Copy(CopyStatement { relation: Table { name: Name(UnresolvedItemName([Ident("google_sheets"), Ident("sheet")])), columns: [Ident("_row"), Ident("a"), Ident("b"), Ident("_fivetran_synced")] }, direction: From, target: Filename("s3://datawriterprd-us-east-1/89dbb4d9-bc11-417d-ac19-e18044e51e75/upload.manifest"), options: [CopyOption { name: Credentials, value: Some(Value(String("aws_access_key_id=ASIA4ESR5FO4SE5RUUXW;aws_secret_access_key=9FnLJQdZL4iaJZEubCL3wlWTAoBNeMVm2UNfgkOC;token=IQoJb3JpZ2luX2VjEJf//////////wEaCXVzLWVhc3QtMSJGMEQCIDa1r+0mo9PWr6DoGpknFZpxO/SGbU/NWYUoS6Co8IWwAiBjIQo1/4hnmGZDD/VeFP7JEEw0wAc56RNdQFVIM4m+6yqgBAiv//////////8BEAAaDDgzNDQ2OTE3ODI5NyIM5SnwMe7q4RPetSlaKvQDegM48jz4iCqwVdprUWvORZNU0MS9ZHlBzVD+oR6Ue78Va2NgOAwLpg8DllEMMw5bCjpYBPIaF8+fHL+CUcvNcobLGAUPdOwNv2ZiZmJhR9Ty/N5gcYQ5lfzFXdzHTTs1fqLq3UUiTC/W4YU+yDQTniBtCN0Tc8XnG9PKUcqdUWSAhF2sob2O+yr8RHyC4fG50KjP7GcQka9rR+fW5t44PU2j7Dv4dgOioscDrTN6Uwh3KDMPsCiVQj+YvBYIoGGMpeRvfqKzDKNkAd5I4ukIKku8BCrtCHF8DUKwWIHiKJjWfKUvVKq0kxsSB6y4a9jdQoZMe1i/JUUWE1EQE3HzPirE8OpUmyO2wtRpKrRQv1nr055zaIUmABVOr95sbM4tOCvzb/uqREHAjR/TXjUqrNQQC4jlAkBETU/r//HABZ2aVaKdMFPHpXByxJsokehXEFuJqFwpkk5V4NPmD0dEjKBfEZRRFz7vvxMjd0At2Wc68OASIXs8vgOHyDlBv0St6Ps7N2wWdzsKB8WOJZoTK2ZKfjXv6xgTGxqVUuUFpc2/yIzwz/qsYFNqCtJWrYMPIOuv6aHK9uyrSRWNaWVIw2IeGNhEnta0h2uo8M2oPb5L6ymPSavykHDKk/U93fOgG/H1T84nMeKW+RzYo8JDG4ZNcIMwpNH1ogY6ngEH/Ec+sHs4zG+nReaRn8PFGF/TaeB9ixCkFinWfmBVRM8Hlq6+ZgE3nvvjJNRlJj39h7N9OZLINjPPUNCF5GLa0kDA9Rloh3p8R9Zn7y2gh5UC2rRW3uea7FTzDRisbJbFjEaGYqOqJ0x/4D9vRZ+7lJnnkNPPB0FMUjMew6XvWRxH4tlZZmwMkiGavea3o9TGAlh/LKHhzHKfjC/B7A==;master_symmetric_key=/bnBIznZImOA+cpQSl9UeKIkOeBCNfh6mTuyXC6Sq7E="))) }, CopyOption { name: Region, value: Some(Value(String("us-east-1"))) }, CopyOption { name: Csv, value: Some(Value(Boolean(true))) }, CopyOption { name: Gzip, value: Some(Value(Boolean(true))) }, CopyOption { name: Ignoreheader, value: Some(Value(Number("1"))) }, CopyOption { name: Null, value: Some(Value(String("null-vba3aoqjpgeovgjvmzn5cklcstanclr"))) }, CopyOption { name: Timeformat, value: Some(Value(String("auto"))) }, CopyOption { name: Dateformat, value: Some(Value(String("auto"))) }, CopyOption { name: Truncatecolumns, value: Some(Value(Boolean(true))) }, CopyOption { name: Acceptinvchars, value: Some(Value(Boolean(true))) }, CopyOption { name: Encrypted, value: Some(Value(Boolean(true))) }, CopyOption { name: Manifest, value: Some(Value(Boolean(true))) }] })
